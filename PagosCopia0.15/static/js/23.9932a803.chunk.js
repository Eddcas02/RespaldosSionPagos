(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[23],{463:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));const a="".concat("http://pagos.sion.com.gt/apipagos/api/","sesionusuario");function c(e,t,n,c,i){var s={IdUsuario:e,Navegador:t,IP:n,Opcion:c};const o=JSON.stringify(s);return fetch(a,{method:"POST",body:o,headers:{Authorization:"Bearer "+i,Accept:"application/json","Content-type":"application/json;charset=UTF-8"}}).then((e=>e.json())).then((e=>e)).catch((e=>e))}},477:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));const a="".concat("http://pagos.sion.com.gt/apipagos/api/","usuarios");function c(e,t,n,c,i){let s=a,o="";return null!==e&&(o+="/"+e),null!==t&&(o+="/"+t),null!==n&&(o+="/"+n),null!==c&&(o+="/"+c),s+=o,fetch(s,{method:"GET",headers:{Authorization:"Bearer "+i,Accept:"application/json"}}).then((function(e){return e.json()})).catch((e=>e))}},485:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.739acbb1.png"},512:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));const a="".concat("http://pagos.sion.com.gt/apipagos/api/","politicas");function c(e,t){let n=a,c="";return null!==e&&(c.length>0?c+="&id_politica="+e:c+="?id_politica="+e),null!==t&&(c.length>0?c+="&descripcion="+t:c+="?descripcion="+t),n+=c,fetch(n).then((function(e){return e.json()})).catch((e=>e))}},560:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));const a="".concat("http://pagos.sion.com.gt/apipagos/api/","loglogin");function c(e,t,n){var c={id_usuario:e,maximo:t};const i=JSON.stringify(c);return fetch(a,{method:"POST",body:i,headers:{Authorization:"Bearer "+n,Accept:"application/json","Content-type":"application/json;charset=UTF-8"}}).then((e=>e.json())).then((e=>e)).catch((e=>e))}},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));const a="".concat("http://pagos.sion.com.gt/apipagos/api/","login");function c(e,t){var n={user:e,password:t};const c=JSON.stringify(n);return fetch(a,{method:"POST",body:c,headers:{Accept:"application/json","Content-type":"application/json;charset=UTF-8"}}).then((e=>e.json())).then((e=>void 0!==e.length?e:null)).catch((e=>e))}},916:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(16),i=n(835),s=n(467),o=n(477),r=n(512);const l="".concat("http://pagos.sion.com.gt/apipagos/api/","calculardias");const u="".concat("http://pagos.sion.com.gt/apipagos/api/","estoyconectado");const d="".concat("http://pagos.sion.com.gt/apipagos/api/","logpassword");var h=n(463),p=n(560),j=n(459),O=n(485),b=n(486),f=n.n(b),m=n(462),g=n(561),x=n(10);t.default=()=>{const e=Object(c.g)(),{saveJWT:t}=Object(j.useSession)("PendrogonIT-Session"),[b,v]=Object(a.useState)(!1),[y,I]=Object(a.useState)(!1),[S,w]=Object(a.useState)(!1),[C,_]=Object(a.useState)(""),[A,E]=Object(a.useState)(""),[N,T]=Object(a.useState)(""),[z,P]=Object(a.useState)([]);Object(a.useEffect)((()=>{let e=!0;return Object(r.a)(null,null).then((t=>{e&&P(t.politicas)})),()=>e=!1}),[]);const[k,B]=Object(a.useState)({usuario:"",password:""}),M=e=>{B({...k,[e.target.name]:e.target.value})};function F(e){let t="";for(let n of z)n.identificador==e&&(t=n.valor);return t}async function R(e,t){let n=!1;return"Conectado"==await function(e,t){let n=u,a="";return null!==e&&(a+="/"+e),n+=a,fetch(n,{method:"GET",headers:{Authorization:"Bearer "+t,Accept:"application/json"}}).then((function(e){return e.json()})).catch((e=>e))}(e,t)&&(n=!0),n}async function J(e,t,a){const c=n(562);let i=window.navigator.userAgent;var s=["Chrome","Firefox","Safari","Opera","Trident","MSIE","Edge"];const o=await c.v4();for(var r in s)if(-1!=i.indexOf(s[r])){if("0"==t)return!0;return"OK"===await Object(h.a)(e,s[r],o,"1",a)}}async function L(e,t,n){let a=!1,c=F("_LIMITE_CAMBIO_PASSWORD_");const i=await function(e,t){let n=l,a="";return null!==e&&(a+="/"+e),n+=a,fetch(n,{method:"GET",headers:{Authorization:"Bearer "+t,Accept:"application/json"}}).then((function(e){return e.json()})).catch((e=>e))}(e,n);if("Vacio"==i){"OK"==await function(e,t){var n={id_usuario:e};const a=JSON.stringify(n);return fetch(d,{method:"POST",body:a,headers:{Authorization:"Bearer "+t,Accept:"application/json","Content-type":"application/json;charset=UTF-8"}}).then((e=>e.json())).then((e=>e)).catch((e=>e))}(e,n)&&(a=!0)}else 1==t?parseInt(i)>=parseInt(c)?(I(!0),T("Aviso!"),E("info"),_("Ya pasaron ".concat(i," d\xedas desde la \xfaltima vez que cambi\xf3 su contrase\xf1a. Debe actualizarla."))):parseInt(i)<parseInt(c)&&(a=!0):0==t&&(a=!0);return a}const U=a=>{a.preventDefault(),Object(g.a)(k.usuario,f()(k.password,{encoding:"binary"})).then((a=>{a?Object(o.a)(null,null,k.usuario,null,a).then((c=>{if(c)if(c.users.length>0){for(let i of c.users)if(f()(k.password,{encoding:"binary"})===i.password)1==i.activo&&0==i.eliminado?L(i.id,i.cambia_password,a).then((c=>{1==c&&R(i.id,a).then((c=>{J(i.id,i.cantidadIngresos,a).then((c=>{if(1==c){let c=F("_LIMITE_TIEMPO_CONEXION_"),s=F("_SEMAFORO_VERDE"),o=F("_SEMAFORO_AMARILLO");const r="secret",l=n(565)({email:i.email,name:i.nombre+" "+i.apellido,user_name:i.nombre_usuario,id:i.id,estado:i.activo,limiteconexion:c,verde:s,amarillo:o,cantidadIngresos:i.cantidadIngresos,api_token:a},r);t(l),"0"==i.cantidadIngresos?e.push("/usuarios/password"):e.push("/home")}}))}))})):(v(!0),T("Error!"),E("danger"),_("Parece que tu usuario ha sido bloqueado o eliminado. Consulta con el soporte t\xe9cnico."));else if(v(!0),T("Error!"),E("danger"),_("Credenciales incorrectas. Vuelva a intentarlo."),1==i.activo&&0==i.eliminado){let e=F("_LIMITE_ERROR_LOGIN_");Object(p.a)(i.id,e,a)}}else v(!0),T("Error!"),E("danger"),_("Credenciales incorrectas. Vuelva a intentarlo.")})):(v(!0),T("Error!"),E("danger"),_("Credenciales incorrectas. Vuelva a intentarlo."))}))};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(i.a,{show:b,variant:A,onClose:()=>v(!1),dismissible:!0,children:[Object(x.jsx)(i.a.Heading,{children:N}),Object(x.jsx)("p",{children:C})]}),Object(x.jsxs)(i.a,{show:y,variant:A,onClose:()=>I(!1),dismissible:!0,children:[Object(x.jsx)(i.a.Heading,{children:N}),Object(x.jsx)("p",{children:C}),Object(x.jsx)("hr",{}),Object(x.jsx)("div",{className:"d-flex justify-content-end",children:Object(x.jsx)(m.c,{onClick:()=>e.push("/recuperar"),color:"primary",variant:"outline",children:"Actualizar Contrase\xf1a"})})]}),Object(x.jsx)("div",{className:"bg-light min-vh-100 d-flex flex-row align-items-center",children:Object(x.jsx)(m.i,{children:Object(x.jsx)(m.B,{className:"justify-content-center",children:Object(x.jsx)(m.h,{md:"9",children:Object(x.jsxs)(m.f,{children:[Object(x.jsx)(m.d,{className:"p-4",children:Object(x.jsx)(m.e,{children:Object(x.jsxs)(m.p,{children:[Object(x.jsx)("h1",{children:"Iniciar Sesi\xf3n"}),Object(x.jsx)("p",{className:"text-medium-emphasis",children:"Inicie sesi\xf3n con su correo o usuario"}),Object(x.jsxs)(m.y,{className:"mb-3",children:[Object(x.jsx)(m.z,{children:Object(x.jsx)(s.z,{})}),Object(x.jsx)(m.r,{placeholder:"Correo o Usuario",name:"usuario",onChange:M})]}),Object(x.jsxs)(m.y,{className:"mb-4",children:[Object(x.jsx)(m.z,{children:Object(x.jsx)(s.r,{})}),Object(x.jsx)(m.r,{type:S?"text":"password",name:"password",placeholder:"Password",onChange:M}),Object(x.jsx)(m.c,{color:"secondary",variant:"outline",onClick:()=>{w(!S)},children:Object(x.jsx)(s.j,{})})]}),Object(x.jsxs)(m.B,{children:[Object(x.jsx)(m.h,{xs:"6",children:Object(x.jsx)(m.c,{type:"submit",color:"primary",className:"px-4",onClick:U,onSubmit:U,children:"Iniciar Sesi\xf3n"})}),Object(x.jsx)(m.h,{xs:"6",className:"text-right",children:Object(x.jsx)(m.c,{color:"link",className:"px-4",onClick:()=>e.push("/recuperar"),children:"Olvidaste contrase\xf1a?"})})]})]})})}),Object(x.jsx)(m.d,{className:"text-blue py-5",children:Object(x.jsx)(m.e,{className:"text-center",children:Object(x.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:Object(x.jsx)("div",{style:{width:"80%",height:"80%",backgroundColor:"transparent"},children:Object(x.jsx)("img",{style:{width:"80%"},src:O.a})})})})})]})})})})})]})}}}]);
//# sourceMappingURL=23.9932a803.chunk.js.map